montageDefine("0d641c0","serialization/serializer",{dependencies:["./malker","./builder","./labeler","./visitor"],factory:function(t,e){(function(e){function n(){var t;this._builder=new a,this._labeler=new r,t=new s(this._builder,this._labeler),this._malker=new i(t)}var i=t("./malker").Malker,a=t("./builder").Builder,r=t("./labeler").Labeler,s=t("./visitor").Visitor;Object.defineProperties(n.prototype,{_labeler:{value:null,writable:!0},_builder:{value:null,writable:!0},_serializationIndentation:{value:2,writable:!0},_malker:{value:null,writable:!0},setSerializationIndentation:{value:function(t){this._serializationIndentation=t}},serialize:{value:function(t){var e;this._labeler.initWithObjects(t);for(var n in t)this._malker.visit(t[n]);return e=this._formatSerialization(this._builder.getSerialization(this._serializationIndentation))}},serializeObject:{value:function(t){return this.serialize({root:t})}},_formatSerializationBindingsRegExp:{value:/\{\s*("(?:<->?)")\s*:\s*("[^"]+"\s*(?:,\s*"converter"\s*:\s*\{\s*"@"\s*:\s*"[^"]+"\s*\}\s*|,\s*"deferred"\s*:\s*(true|false)\s*)*)\}/gi},_formatSerializationBindingsReplacer:{value:function(t,e,n){return"{"+e+": "+n.replace(/\n\s*/g,"").replace(/,\s*/g,", ")+"}"}},_formatSerializationBindings:{value:function(t){return t.replace(this._formatSerializationBindingsRegExp,this._formatSerializationBindingsReplacer)}},_formatSerializationReferencesRegExp:{value:/\{\s*("[#@]")\s*:\s*("[^"]+")\s*\}/gi},_formatSerializationReferences:{value:function(t){return t.replace(this._formatSerializationReferencesRegExp,"{$1: $2}")}},_formatSerialization:{value:function(t){return this._formatSerializationBindings(this._formatSerializationReferences(t))}}}),e.Serializer=n,e.serialize=function(t){return(new n).serializeObject(t)}})(e)}});